<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <link rel="shortcut icon" href="imagens/Caixa de presente com laÃ§o.png" type="image/x-icon">
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Lista de Presentes - Casamento</title>
  <style>
    html,body{font-family:'Lato',sans-serif;margin:0;padding:0;background-color:#fff8f0;color:#404040}
    header{background-color:#2e7d32;color:#fff;text-align:center;padding:2rem;font-size:2rem;font-weight:bold;border-bottom:3px solid #d4af37}
    main{max-width:1200px;margin:2rem auto;padding:0 1rem;display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:1.5rem}
    .card{background:#fff;border-radius:12px;box-shadow:0 3px 6px rgba(0,0,0,.16);overflow:hidden;display:flex;flex-direction:column;transition:transform .3s;border-top:5px solid #d4af37}
    .card:hover{transform:scale(1.03)}
    .card img{width:100%;height:180px;object-fit:contain;background:#eee}
    .card-content{padding:1rem;flex:1;display:flex;flex-direction:column;justify-content:space-between}
    .card h3{font-size:1.2rem;margin-bottom:.5rem;color:#2e7d32}
    .card p{font-size:.95rem;color:#555;margin-bottom:.8rem}
    button{background-color:#2e7d32;border:none;color:#fff;padding:.75rem;border-radius:8px;cursor:pointer;font-size:1rem;transition:background .3s}
    button:hover{background-color:#256028}
    button[disabled]{background:#ccc;cursor:not-allowed}
    input{padding:.5rem;width:80px;text-align:center;margin-bottom:.8rem;border-radius:5px;border:1px solid #ccc}
    #confirmModal,#pixModal{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.6);display:flex;justify-content:center;align-items:center;visibility:hidden;opacity:0;transition:.2s}
    #confirmModal.active,#pixModal.active{visibility:visible;opacity:1}
    .modal{background:#fff;padding:1.5rem;border-radius:12px;max-width:480px;width:90%;text-align:center;box-shadow:0 5px 15px rgba(0,0,0,.3);border-top:5px solid #d4af37}
    .modal h2{color:#2e7d32;margin-bottom:.8rem}
    .modal p{margin:.4rem 0}
    .modal .row{display:flex;gap:.5rem;justify-content:center;align-items:center;margin-top:.6rem}
    .copy-btn{background:#d4af37;color:#fff;padding:.5rem 1rem;border-radius:8px;border:none;cursor:pointer}
    .small{font-size:.95rem;color:#666;margin-top:.6rem}
    #compradorWrapper{max-width:480px;margin:1rem auto;text-align:center}
    #nomeComprador{padding:.5rem;width:80%;border-radius:5px;border:1px solid #ccc;font-size:1rem}
  </style>
</head>
<body>
<header>ðŸŽ€ Lista de Presentes - ChÃ¡ De Casa Nova</header>

<div id="compradorWrapper">
  <input type="text" id="nomeComprador" placeholder="Digite seu nome">
</div>

<main id="catalogo"></main>

<div id="confirmModal">
  <div class="modal">
    <h2>Confirmar presente</h2>
    <p id="conf-nome">Produto: â€”</p>
    <p id="conf-qtd">Quantidade: â€”</p>
    <p id="conf-unit">Valor unitÃ¡rio: â€”</p>
    <p id="conf-total" style="font-weight:700">Total: â€”</p>

    <div class="small">Pix para pagamento:</div>
    <div style="margin:0.5rem 0;">
      <strong id="pix-key">21 971963818</strong>
    </div>

    <div class="row">
      <button class="copy-btn" onclick="copiarPix()">Copiar Pix</button>
      <button onclick="confirmarCompra()">Confirmar pagamento</button>
      <button onclick="fecharConfirm()">Cancelar</button>
    </div>
    <p id="conf-msg" class="small"></p>
  </div>
</div>

<div id="pixModal">
  <div class="modal">
    <h2>ðŸŽ‰ Obrigado pela sua contribuiÃ§Ã£o!</h2>
    <p>Envie o comprovante via WhatsApp (ou aguarde contato).</p>
    <p class="small">PIX: <strong>21 971963818</strong></p>
    <div class="row">
      <button onclick="fecharPix()">Fechar</button>
    </div>
  </div>
</div>

<script>
const PIX_KEY="21 971963818";
const SCRIPT_URL="https://script.google.com/macros/s/AKfycbx68kIYLxZsN0eDyZfkCSLnRwEHjhArsEjKXdUyFrIJ2IAOIspf94n2jkqST2FOhZk19g/exec";

const produtos=[
  // Valer maiores que 1 = vales
  {nome:"Micro-ondas", limite:6, valor:100},
  {nome:"FogÃ£o", limite:10, valor:100},
  {nome:"ArmÃ¡rio de cozinha", limite:5, valor:100},
  {nome:"Geladeira", limite:15, valor:100},
  {nome:"Painel para TV", limite:2, valor:100},
  {nome:"SofÃ¡", limite:10, valor:100},
  {nome:"TelevisÃ£o", limite:15, valor:100},
  {nome:"Ar-condicionado", limite:10, valor:100},
  {nome:"ArmÃ¡rio", limite:10, valor:100},
  {nome:"ColchÃ£o de casa D20", limite:3, valor:100},
  {nome:"Sapateira", limite:3, valor:100},
  {nome:"MÃ¡quina de lavar", limite:10, valor:100},
  {nome:"Aspirador de pÃ³", limite:3, valor:100},
  {nome:"Panela de pressÃ£o", limite:6, valor:150},
  {nome:"Jogo de panela", limite:6, valor:150},
  // Itens de limite 1 = item
  {nome:"Sanduicheira", limite:1, valor:100},
  {nome:"Liquidificador", limite:1, valor:170},
  {nome:"Mixer", limite:1, valor:170},
  {nome:"Jogo de canecas", limite:1, valor:75},
  {nome:"Jogo de pratos de porcelanato", limite:1, valor:100},
  {nome:"UtensÃ­lios de silicone", limite:1, valor:50},
  {nome:"Boleira de vidro", limite:1, valor:50},
  {nome:"Garrafa tÃ©rmica", limite:1, valor:55},
  {nome:"Escorredor de louÃ§a de parede", limite:1, valor:60},
  {nome:"Escorredores de inox", limite:1, valor:70},
  {nome:"Talheres", limite:1, valor:60},
  {nome:"Potes hermÃ©ticos J1", limite:1, valor:90},
  {nome:"Potes hermÃ©ticos J2", limite:1, valor:105},
  {nome:"Jogo de copos de vidro", limite:1, valor:65},
  {nome:"Jogo de tabuleiros", limite:1, valor:85},
  {nome:"Jogo de pirex", limite:1, valor:100},
  {nome:"Ralador", limite:1, valor:50},
  {nome:"TÃ¡bua de inox", limite:1, valor:50},
  {nome:"Lixeiras", limite:1, valor:55},
  {nome:"Suporte para papel higiÃªnico", limite:1, valor:55},
  {nome:"Kits suporte de toalha", limite:1, valor:75},
  {nome:"Espelho", limite:1, valor:80},
  {nome:"Toalhas de banho", limite:1, valor:100},
  {nome:"Toalhas de rosto", limite:1, valor:50},
  {nome:"Kit porta algodÃ£o, escova e cotonete + saboneteira", limite:1, valor:70},
  {nome:"Cortina", limite:1, valor:100},
  {nome:"Tapete", limite:1, valor:70},
  {nome:"Capa de almofada", limite:1, valor:90},
  {nome:"Edredom", limite:1, valor:120},
  {nome:"2 jogos de lenÃ§ol", limite:1, valor:70},
  {nome:"Travesseiros", limite:1, valor:75},
  {nome:"Cabeceira", limite:1, valor:60},
  {nome:"Capa de colchÃ£o impermeÃ¡vel", limite:1, valor:50},
  {nome:"Sexto de roupa", limite:1, valor:50},
  {nome:"Mope", limite:1, valor:50},
  {nome:"Ferro de passar roupa", limite:1, valor:110},
  {nome:"TÃ¡bua de passar roupa", limite:1, valor:100},
  {nome:"Varal de teto", limite:1, valor:65},
  {nome:"Varal de chÃ£o", limite:1, valor:90},
];

const imagensProdutos = {
  "Ar-condicionado":"imagens/ARCONDICIONADO.jpg",
  "ArmÃ¡rio":"imagens/ARMARIO.jpg",
  "ArmÃ¡rio de banheiro":"imagens/ARMARIODEBANHEIRO.jpg",
  "ArmÃ¡rio de cozinha":"imagens/ARMARIODECOZINHA.jpg",
  "Aspirador de pÃ³":"imagens/ASPIRADORDEPO.jpg",
  "Boleira de vidro":"imagens/BOLEIRADEVIDRO.jpg",
  "Capa de almofada":"imagens/CAPADEALMOFADA.jpg",
  "Cabeceira":"imagens/CABECEIRA.jpg",
  "Capa de colchÃ£o impermeÃ¡vel":"imagens/CAPADECOLCHÃƒOIMPERMEAVEL.jpg",
  "Cesto de roupa":"imagens/CESTODEROUPA.jpg",
  "Chaleira":"imagens/CHALEIRA.jpg",
  "ColchÃ£o de casa D20":"imagens/COLCHAO.jpg",
  "Cortina":"imagens/CORTINA.jpg",
  "Edredom":"imagens/EDREDOM.jpg",
  "Escorredores de inox":"imagens/ESCORREDORDEINOX.jpeg",
  "Escorredor de louÃ§a de parede":"imagens/ESCORREDORDELOUÃ‡ADEPARADE.jpg",
  "Espelho":"imagens/ESPELHO.jpg",
  "Ferro de passar roupa":"imagens/FERRODEPASSAR.jpg",
  "FogÃ£o":"imagens/FOGAO.jpg",
  "Garrafa tÃ©rmica":"imagens/GARRAFATERMICA.jpg",
  "Geladeira":"imagens/GELADEIRA.jpg",
  "Jarra de suco":"imagens/JARRADESUCO.jpg",
  "Jogo de canecas":"imagens/JOGODECANECAS.jpg",
  "Jogo de copos de vidro":"imagens/JOGODECOPOSDEVIDRO.jpg",
  "2 jogos de lenÃ§ol":"imagens/JOGODELENÃ‡OL.jpg",
  "Jogo de panela":"imagens/JOGODEPANELA.jpg",
  "Jogo de pirex":"imagens/JOGODEPIREX.jpg",
  "Jogo de pratos de porcelanato":"imagens/JOGODEPRATOSPORCELANADO.jpg",
  "Jogo de tabuleiros":"imagens/JOGODETABULEIROS.jpg",
  "Kit porta algodÃ£o, escova e cotonete + saboneteira":"imagens/Kit porta algodÃ£o, escova e cotonete + saboneteira.jpg",
  "Kits suporte de toalha":"imagens/KITSUPORTEDETOALHA.jpg",
  "Liquidificador":"imagens/LIQUIDIFICADOR.jpg",
  "Lixeiras":"imagens/LIXEIRA.jpeg",
  "Micro-ondas":"imagens/MICROONDAS.jpg",
  "MÃ¡quina de lavar":"imagens/MAQUINADELAVAR.jpeg",
  "Mixer":"imagens/MIXER.jpg",
  "Mope":"imagens/MOPE.jpg",
  "Painel para TV":"imagens/PAINELPARATV.jpg",
  "Panela de pressÃ£o":"imagens/PANELADEPRESSÃƒO.jpg",
  "Potes hermÃ©ticos J1":"imagens/POTESHERMETICOSJ1.jpg",
  "Potes hermÃ©ticos J2":"imagens/POTESHERMETICOSJ2.jpg",
  "Ralador":"imagens/RALADOR.jpg",
  "Suporte para papel higiÃªnico":"imagens/SUPORTEHIGIENICO.jpeg",
  "Sexto de roupa":"imagens/SEXTODEROUPA.jpg",
  "Sanduicheira":"imagens/SANDUUICHEIRA.jpg",
  "Sapateira":"imagens/SAPATEIRA.jpg",
  "SofÃ¡":"imagens/SOFÃ.jpg",
  "Travesseiros":"imagens/TRAVESSEIRO.jpeg",
  "TÃ¡bua de inox":"imagens/TABUADEINOX.jpg",
  "TÃ¡bua de passar roupa":"imagens/TABUADEPASSAR.jpg",
  "Talheres":"imagens/TALHERES.jpg",
  "Tapete":"imagens/TAPETE.jpg",
  "TelevisÃ£o":"imagens/TELEVISÃƒO.jpg",
  "Toalhas de banho":"imagens/TOALHASDEBANHO.jpg",
  "Toalhas de rosto":"imagens/TOALHASDEROSTO.jpg",
  "UtensÃ­lios de silicone":"imagens/UTENCILIOSDESILICONE.jpg",
  "Varal de chÃ£o":"imagens/VARALCHAO.jpg",
  "Varal de teto":"imagens/VARALTETO.jpg"
};

const catalogo=document.getElementById("catalogo");
let escolhidos=JSON.parse(localStorage.getItem("itensEscolhidos"))||[];

function criarCards(){
  produtos.forEach((prod,id)=>{
    const card=document.createElement("div");
    card.className="card";
    card.dataset.id=id;
    card.dataset.nome=prod.nome;
    card.dataset.limite=prod.limite;
    card.dataset.valor=prod.valor;

    const imgSrc=imagensProdutos[prod.nome]||`https://via.placeholder.com/300x180?text=${encodeURIComponent(prod.nome)}`;

    let inputHTML='';
    if(prod.limite>1) inputHTML=`<input type="number" id="quantidade-${id}" value="1" min="1" max="${prod.limite}">`;

    const tipoTexto=prod.limite===1?`Item: R$ ${prod.valor}`:`Vale: limite ${prod.limite}, R$ ${prod.valor}`;

    card.innerHTML=`
      <img src="${imgSrc}" alt="${prod.nome}">
      <div class="card-content">
        <h3>${prod.nome}</h3>
        <p>${tipoTexto}</p>
        ${inputHTML}
        <div style="display:flex;gap:.5rem;justify-content:center;align-items:center">
          <button onclick="abrirConfirm(this)">Escolher</button>
        </div>
      </div>
    `;

    if(escolhidos.includes(String(id))){
      const btn=card.querySelector("button");
      btn.textContent="Escolhido"; btn.disabled=true; card.style.opacity=0.6;
    }
    catalogo.appendChild(card);
  });
}

const confirmModal=document.getElementById('confirmModal');
const pixModal=document.getElementById('pixModal');
let currentSelection=null;

function abrirConfirm(btn){
  const card=btn.closest('.card');
  const id=card.dataset.id;
  const nome=card.dataset.nome;
  const limite=parseInt(card.dataset.limite);
  const valor=parseFloat(card.dataset.valor);
  let quantidade=1;
  if(limite>1) quantidade=parseInt(document.getElementById(`quantidade-${id}`).value)||1;

  const comprador=document.getElementById("nomeComprador").value.trim();
  if(!comprador){ alert("Informe seu nome antes de escolher."); return; }
  if(quantidade<1){ alert("Informe uma quantidade vÃ¡lida"); return; }
  if(limite>1 && quantidade>limite){ alert("Quantidade maior que o limite"); return; }

  currentSelection={id,nome,limite,quantidade,valor,comprador};

  document.getElementById('conf-nome').textContent=`Produto: ${nome}`;
  document.getElementById('conf-qtd').textContent=`Quantidade: ${quantidade}`;
  document.getElementById('conf-unit').textContent=`Valor unitÃ¡rio: R$ ${valor.toFixed(2).replace('.',',')}`;
  document.getElementById('conf-total').textContent=`Total: R$ ${(valor*quantidade).toFixed(2).replace('.',',')}`;
  document.getElementById('pix-key').textContent=PIX_KEY;
  document.getElementById('conf-msg').textContent='';

  confirmModal.classList.add('active');
}

function fecharConfirm(){ confirmModal.classList.remove('active'); currentSelection=null; }
function copiarPix(){ navigator.clipboard.writeText(PIX_KEY).then(()=>{document.getElementById('conf-msg').textContent='Chave PIX copiada.'}).catch(()=>{document.getElementById('conf-msg').textContent='NÃ£o foi possÃ­vel copiar.'}); }

async function confirmarCompra(){
  if(!currentSelection) return;
  const {id,nome,limite,quantidade,valor,comprador}=currentSelection;
  document.getElementById('conf-msg').textContent='Registrando...';
  try{
    const params=new URLSearchParams({nome, quantidade:String(quantidade), limite:String(limite), valor:String(valor), comprador});
    const res=await fetch(`${SCRIPT_URL}?${params.toString()}`);
    const data=await res.json();
    if(data.status==='ok'){
      escolhidos.push(String(id));
      localStorage.setItem('itensEscolhidos',JSON.stringify(escolhidos));
      marcarComoEscolhido(id);
      fecharConfirm();
      abrirPixModal();
    } else document.getElementById('conf-msg').textContent=data.mensagem||'Erro ao registrar.';
  } catch(err){
    console.error(err);
    document.getElementById('conf-msg').textContent='Erro de comunicaÃ§Ã£o.';
  }
}

function marcarComoEscolhido(id){
  const card=document.querySelector(`.card[data-id="${id}"]`);
  if(!card) return;
  const btn=card.querySelector('button');
  btn.textContent='Escolhido'; btn.disabled=true; card.style.opacity=0.6;
}

function abrirPixModal(){ pixModal.classList.add('active'); }
function fecharPix(){ pixModal.classList.remove('active'); }

criarCards();
document.querySelectorAll('.card').forEach(card=>{ const id=String(card.dataset.id); if(escolhidos.includes(id)) marcarComoEscolhido(id); });
</script>
</body>
</html>
