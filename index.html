<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <link rel="shortcut icon" href="imagens/Caixa de presente com laço.png" type="image/x-icon">
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Lista de Presentes - Casamento</title>
  <style>
    html,body{font-family:'Lato',sans-serif;margin:0;padding:0;background-color:#fff8f0;color:#404040}
    header{background-color:#2e7d32;color:#fff;text-align:center;padding:2rem;font-size:2rem;font-weight:bold;border-bottom:3px solid #d4af37}
    main{max-width:1200px;margin:2rem auto;padding:0 1rem;display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:1.5rem}
    .card{background:#fff;border-radius:12px;box-shadow:0 3px 6px rgba(0,0,0,.16);overflow:hidden;display:flex;flex-direction:column;transition:transform .3s;border-top:5px solid #d4af37}
    .card:hover{transform:scale(1.03)}
    .card img{width:100%;height:180px;object-fit:contain;background:#eee}
    .card-content{padding:1rem;flex:1;display:flex;flex-direction:column;justify-content:space-between}
    .card h3{font-size:1.2rem;margin-bottom:.5rem;color:#2e7d32}
    .card p{font-size:.95rem;color:#555;margin-bottom:.8rem}
    button{background-color:#2e7d32;border:none;color:#fff;padding:.75rem;border-radius:8px;cursor:pointer;font-size:1rem;transition:background .3s}
    button:hover{background-color:#256028}
    button[disabled]{background:#ccc;cursor:not-allowed}
    input{padding:.5rem;width:80px;text-align:center;margin-bottom:.8rem;border-radius:5px;border:1px solid #ccc}

    #confirmModal,#pixModal{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.6);display:flex;justify-content:center;align-items:center;visibility:hidden;opacity:0;transition:.2s}
    #confirmModal.active,#pixModal.active{visibility:visible;opacity:1}
    .modal{background:#fff;padding:1.5rem;border-radius:12px;max-width:480px;width:90%;text-align:center;box-shadow:0 5px 15px rgba(0,0,0,.3);border-top:5px solid #d4af37}
    .modal h2{color:#2e7d32;margin-bottom:.8rem}
    .modal p{margin:.4rem 0}
    .modal .row{display:flex;gap:.5rem;justify-content:center;align-items:center;margin-top:.6rem}
    .copy-btn{background:#d4af37;color:#fff;padding:.5rem 1rem;border-radius:8px;border:none;cursor:pointer}
    .small{font-size:.95rem;color:#666;margin-top:.6rem}
    .success{color:green}
    .error{color:#e84155}

    #compradorWrapper{max-width:480px;margin:1rem auto;text-align:center}
    #nomeComprador{padding:.5rem;width:80%;border-radius:5px;border:1px solid #ccc;font-size:1rem}
  </style>
</head>
<body>
<header>🎀 Lista de Presentes - Chá De Casa Nova</header>

<div id="compradorWrapper">
  <input type="text" id="nomeComprador" placeholder="Digite seu nome">
</div>

<main id="catalogo">
  <!-- cards preenchidos via JS -->
</main>

<div id="confirmModal">
  <div class="modal">
    <h2>Confirmar presente</h2>
    <p id="conf-nome">Produto: —</p>
    <p id="conf-qtd">Quantidade: —</p>
    <p id="conf-unit">Valor unitário: —</p>
    <p id="conf-total" style="font-weight:700">Total: —</p>

    <div class="small">Pix para pagamento:</div>
    <div style="margin:0.5rem 0;">
      <strong id="pix-key">21 971963818</strong>
    </div>

    <div class="row">
      <button class="copy-btn" onclick="copiarPix()">Copiar Pix</button>
      <button onclick="confirmarCompra()">Confirmar pagamento</button>
      <button onclick="fecharConfirm()">Cancelar</button>
    </div>

    <p id="conf-msg" class="small"></p>
  </div>
</div>

<div id="pixModal">
  <div class="modal">
    <h2>🎉 Obrigado pela sua contribuição!</h2>
    <p>Envie o comprovante via WhatsApp (ou aguarde contato).</p>
    <p class="small">PIX: <strong>21 971963818</strong></p>
    <div class="row">
      <button onclick="fecharPix()">Fechar</button>
    </div>
  </div>
</div>

<script>
const PIX_KEY = "21 971963818";
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbx68kIYLxZsN0eDyZfkCSLnRwEHjhArsEjKXdUyFrIJ2IAOIspf94n2jkqST2FOhZk19g/exec";

// Preços individuais de cada produto
const precosProdutos = {
  "Sanduicheira":100,"Liquidificador":100,"Mixer":170,"Jogo de canecas":75,
  "Jogo de pratos de porcelanato":100,"Utensílios de silicone":50,"Boleira de vidro":50,
  "Garrafa térmica":55,"Escorredor de louça de parede":60,"Escorredores de inox":70,
  "Talheres":60,"Potes herméticos J1":90,"Potes herméticos J2":105,"Jogo de copos de vidro":65,
  "Jogo de tabuleiros":85,"Jogo de pirex":100,"Ralador":50,"Tábua de inox":50,"Lixeiras":55,
  "Suporte para papel higiênico":55,"Kits suporte de toalha":75,"Espelho":80,"Toalhas de banho":100,
  "Toalhas de rosto":50,"Kit porta algodão, escova e cotonete + saboneteira":70,"Cortina":100,
  "Tapete":70,"Capa de almofada":90,"Edredom":120,"2 jogos de lençol":70,"Travesseiros":75,
  "Cabeceira":60,"Capa de colchão impermeável":50,"Sexto de roupa":50,"Mope":50,
  "Ferro de passar roupa":110,"Tábua de passar roupa":100,"Varal de teto":65,"Varal de chão":90,
  "Micro-ondas":100,"Fogão":100,"Armário de cozinha":100,"Geladeira":100,"Painel para TV":100,
  "Sofá":100,"Televisão":100,"Ar-condicionado":100,"Armário":100,"Colchão de casa D20":100,
  "Sapateira":100,"Máquina de lavar":100,"Aspirador de pó":100,"Panelas":100,"Panela de pressão":150
};

const imagensProdutos = {
  "Ar-condicionado": "imagens/ARCONDICIONADO.jpg",
  "Armário": "imagens/ARMARIO.jpg",
  "Armário de banheiro": "imagens/ARMARIODEBANHEIRO.jpg",
  "Armário de cozinha": "imagens/ARMARIODECOZINHA.jpg",
  "Aspirador de pó": "imagens/ASPIRADORDEPO.jpg",
  "Boleira de vidro": "imagens/BOLEIRADEVIDRO.jpg",
  "Capa de almofada": "imagens/CAPADEALMOFADA.jpg",
  "Cabeceira": "imagens/CABECEIRA.jpg",
  "Capa de colchão impermeável": "imagens/CAPADECOLCHÃOIMPERMEAVEL.jpg",
  "Cesto de roupa": "imagens/CESTODEROUPA.jpg",
  "Chaleira": "imagens/CHALEIRA.jpg",
  "Colchão de casa D20": "imagens/COLCHAO.jpg",
  "Cortina": "imagens/CORTINA.jpg",
  "Edredom": "imagens/EDREDOM.jpg",
  "Escorredores de inox": "imagens/ESCORREDORDEINOX.jpeg",
  "Escorredor de louça de parede": "imagens/ESCORREDORDELOUÇADEPARADE.jpg",
  "Espelho": "imagens/ESPELHO.jpg",
  "Ferro de passar roupa": "imagens/FERRODEPASSAR.jpg",
  "Fogão": "imagens/FOGAO.jpg",
  "Garrafa térmica": "imagens/GARRAFATERMICA.jpg",
  "Geladeira": "imagens/GELADEIRA.jpg",
  "Jarra de suco": "imagens/JARRADESUCO.jpg",
  "Jogo de canecas": "imagens/JOGODECANECAS.jpg",
  "Jogo de copos de vidro": "imagens/JOGODECOPOSDEVIDRO.jpg",
  "2 jogos de lençol": "imagens/JOGODELENÇOL.jpg",
  "Jogo de panela": "imagens/JOGODEPANELA.jpg",
  "Jogo de pirex": "imagens/JOGODEPIREX.jpg",
  "Jogo de pratos de porcelanato": "imagens/JOGODEPRATOSPORCELANADO.jpg",
  "Jogo de tabuleiros": "imagens/JOGODETABULEIROS.jpg",
  "Kit porta algodão, escova e cotonete + saboneteira": "imagens/Kit porta algodão, escova e cotonete + saboneteira.jpg",
  "Kits suporte de toalha": "imagens/KITSUPORTEDETOALHA.jpg",
  "Liquidificador": "imagens/LIQUIDIFICADOR.jpg",
  "Lixeiras": "imagens/LIXEIRA.jpeg",
  "Micro-ondas": "imagens/MICROONDAS.jpg",
  "Máquina de lavar": "imagens/MAQUINADELAVAR.jpeg",
  "Mixer": "imagens/MIXER.jpg",
  "Mope": "imagens/MOPE.jpg",
  "Painel para TV": "imagens/PAINELPARATV.jpg",
  "Panela de pressão": "imagens/PANELADEPRESSÃO.jpg",
  "Potes herméticos J1": "imagens/POTESHERMETICOSJ1.jpg",
  "Potes herméticos J2": "imagens/POTESHERMETICOSJ2.jpg",
  "Ralador": "imagens/RALADOR.jpg",
  "Suporte para papel higiênico": "imagens/SUPORTEHIGIENICO.jpeg",
  "Sexto de roupa": "imagens/SEXTODEROUPA.jpg",
  "Sanduicheira": "imagens/SANDUUICHEIRA.jpg",
  "Sapateira": "imagens/SAPATEIRA.jpg",
  "Sofá": "imagens/SOFÁ.jpg",
  "Travesseiros": "imagens/TRAVESSEIRO.jpeg",
  "Tábua de inox": "imagens/TABUADEINOX.jpg",
  "Tábua de passar roupa": "imagens/TABUADEPASSAR.jpg",
  "Talheres": "imagens/TALHERES.jpg",
  "Tapete": "imagens/TAPETE.jpg",
  "Televisão": "imagens/TELEVISÃO.jpg",
  "Toalhas de banho": "imagens/TOALHASDEBANHO.jpg",
  "Toalhas de rosto": "imagens/TOALHASDEROSTO.jpg",
  "Utensílios de silicone": "imagens/UTENCILIOSDESILICONE.jpg",
  "Varal de chão": "imagens/VARALCHAO.jpg",
  "Varal de teto": "imagens/VARALTETO.jpg"
};

const produtosComLimite = [
  {nome:"Micro-ondas", limite:6},
  {nome:"Fogão", limite:10},
  {nome:"Armário de cozinha", limite:5},
  {nome:"Geladeira", limite:15},
  {nome:"Painel para TV", limite:2},
  {nome:"Sofá", limite:10},
  {nome:"Televisão", limite:15},
  {nome:"Ar-condicionado", limite:10},
  {nome:"Armário", limite:10},
  {nome:"Colchão de casa D20", limite:3},
  {nome:"Sapateira", limite:3},
  {nome:"Máquina de lavar", limite:10},
  {nome:"Aspirador de pó", limite:3},
  {nome:"Panelas", limite:6}
];

const produtosNormais = [
  "Sanduicheira","Liquidificador","Mixer","Jogo de canecas","Jogo de pratos de porcelanato",
  "Utensílios de silicone","Boleira de vidro","Garrafa térmica","Escorredor de louça de parede",
  "Escorredores de inox","Talheres","Potes herméticos J1","Potes herméticos J2",
  "Jogo de copos de vidro","Jogo de tabuleiros","Jogo de pirex","Ralador","Tábua de inox",
  "Lixeiras","Suporte para papel higiênico","Kits suporte de toalha","Espelho","Toalhas de banho",
  "Toalhas de rosto","Kit porta algodão, escova e cotonete + saboneteira","Cortina","Tapete",
  "Capa de almofada","Edredom","2 jogos de lençol","Travesseiros","Cabeceira",
  "Capa de colchão impermeável","Sexto de roupa","Mope","Ferro de passar roupa","Tábua de passar roupa",
  "Varal de teto","Varal de chão","Panela de pressão"
];

const catalogo=document.getElementById("catalogo");
let escolhidos=JSON.parse(localStorage.getItem("itensEscolhidos"))||[];

function criarCards(){
  let id=1;
  produtosComLimite.forEach(prod=>{
    const card=criarCard(prod.nome,id,prod.limite);
    catalogo.appendChild(card);
    id++;
  });
  produtosNormais.forEach(prod=>{
    const card=criarCard(prod,id,1);
    catalogo.appendChild(card);
    id++;
  });
}

function criarCard(nome,id,limite){
  const div=document.createElement("div");
  div.className="card";
  div.dataset.id=id;
  div.dataset.nome=nome;
  div.dataset.limite=String(limite);

  const imgSrc = imagensProdutos[nome] || `https://via.placeholder.com/300x180?text=${encodeURIComponent(nome)}`;
  let inputHTML = '';
  if(limite > 1){
    inputHTML = `<input type="number" id="quantidade-${id}" value="1" min="1" max="${limite}">`;
  }
  const tipoTexto = limite === 1 ? 'Item' : `Limite de vales: ${limite}`;

  div.innerHTML=`
    <img src="${imgSrc}" alt="${nome}">
    <div class="card-content">
      <h3>${nome}</h3>
      <p>${tipoTexto}</p>
      ${inputHTML}
      <div style="display:flex;gap:.5rem;justify-content:center;align-items:center">
        <button onclick="abrirConfirm(this)">Escolher</button>
      </div>
    </div>
  `;

  if(escolhidos.includes(String(id))){
    const btn=div.querySelector("button");
    btn.textContent="Escolhido"; 
    btn.disabled=true; 
    div.style.opacity=0.6;
  }
  return div;
}

const confirmModal=document.getElementById('confirmModal');
const pixModal=document.getElementById('pixModal');
let currentSelection=null;

function abrirConfirm(btn){
  const card=btn.closest('.card');
  const id=card.dataset.id;
  const nome=card.dataset.nome;
  const limite=parseInt(card.dataset.limite);
  let quantidade = 1;
  if(limite > 1){
    quantidade = parseInt(document.getElementById(`quantidade-${id}`).value)||1;
  }

  const comprador=document.getElementById("nomeComprador").value.trim();
  if(!comprador){ alert("Informe seu nome antes de escolher."); return; }
  if(quantidade<1){ alert("Informe uma quantidade válida"); return; }
  if(limite>1 && quantidade>limite){ alert("Quantidade maior que o limite"); return; }

  currentSelection={id:String(id),nome,limite,quantidade,comprador};

  const unitPrice = precosProdutos[nome] || 100;

  document.getElementById('conf-nome').textContent=`Produto: ${nome}`;
  document.getElementById('conf-qtd').textContent=`Quantidade: ${quantidade}`;
  document.getElementById('conf-unit').textContent=`Valor unitário: R$ ${unitPrice.toFixed(2).replace('.',',')}`;
  document.getElementById('conf-total').textContent=`Total: R$ ${(unitPrice*quantidade).toFixed(2).replace('.',',')}`;
  document.getElementById('pix-key').textContent=PIX_KEY;
  document.getElementById('conf-msg').textContent='';

  confirmModal.classList.add('active');
}

function fecharConfirm(){ confirmModal.classList.remove('active'); currentSelection=null; }
function copiarPix(){
  navigator.clipboard.writeText(PIX_KEY).then(()=>{document.getElementById('conf-msg').textContent='Chave PIX copiada.'}).catch(()=>{document.getElementById('conf-msg').textContent='Não foi possível copiar.'});
}

async function confirmarCompra(){
  if(!currentSelection) return;
  const {id,nome,limite,quantidade,comprador}=currentSelection;
  document.getElementById('conf-msg').textContent='Registrando...';
  try{
    const params=new URLSearchParams({nome, quantidade:String(quantidade), limite:String(limite), comprador});
    const res=await fetch(`${SCRIPT_URL}?${params.toString()}`);
    const data=await res.json();
    if(data.status==='ok'){
      escolhidos.push(String(id));
      localStorage.setItem('itensEscolhidos',JSON.stringify(escolhidos));
      marcarComoEscolhido(id);
      fecharConfirm();
      abrirPixModal();
    } else{
      document.getElementById('conf-msg').textContent=data.mensagem||'Erro ao registrar.';
    }
  } catch(err){
    console.error(err);
    document.getElementById('conf-msg').textContent='Erro de comunicação.';
  }
}

function marcarComoEscolhido(id){
  const card=document.querySelector(`.card[data-id="${id}"]`);
  if(!card) return;
  const btn=card.querySelector('button');
  btn.textContent='Escolhido'; btn.disabled=true; card.style.opacity=0.6;
}
function abrirPixModal(){ pixModal.classList.add('active'); }
function fecharPix(){ pixModal.classList.remove('active'); }

criarCards();
document.querySelectorAll('.card').forEach(card=>{ const id=String(card.dataset.id); if(escolhidos.includes(id)) marcarComoEscolhido(id); });
</script>
</body>
</html>
